-- SUBQUERY Exercises 2
-- Queries in the HAVING or as an in-line view

/* 
Level 1 queries require aggregation but not a subquery or in-line view.  
Level 2 queries require a subquery.
Level 3 requires both subqueries and aggregation.
*/


/* 1. (Level 3) List each broker name, trade id, transaction time and 
price_total for each broker's personal highest trade. (Trade with the highest 
price total.)
*/


/* 2. (Level 3) Rewrite the previous query to avoid a correlated subquery. 
(Or rewrite to use a correlated subquery.)
*/


/* 3. (Level 1)	Display stock exchange symbols, currency names and the 
average size of all trades at the exchange without broker’s fees.  To get the 
size of the trade, multiply the number of shares by the price in the stock 
price table.  
*/


/* 4. (Level 1) Write a query which shows the number of clients in the town
of Falkirk.
*/


/* 5. (Level 3) Write a query which shows the name(s) of consultants who have 
assignments for all the clients in Falkirk.
*/



/* 6. Write a query that returns highest number of trades made by 
any broker (and only that number).
(Level 1 if you use nested aggregation functions.
 Level 3 if you use an in-line view)
*/


/* 7. (Level 3)	Write a query that returns the name and number of trades for 
the broker who made the most trades.
*/



/* 8. Write a query that returns the highest number of trades made 
by any broker during any single month/year (and only that number).
(Level 1 if you use nested aggregation functions.
 Level 3 if you use an in-line view)
*/


/* 9. (Level 3)	Write a query that returns the name, the month/year and number 
of trades for the broker who has the highest number of trades in any single 
month. (One record or possible ties for first place)
*/


/* 10. (Level 3)	Write a query that returns the month/year, the name of the 
broker and number of trades for the broker who has the highest number of 
trades in that month. (One record for each month.)
*/





